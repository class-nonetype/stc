<section class="inbox-container">
  @if (loading()) {
    <div class="inbox-skeleton" role="presentation" aria-hidden="true">
      <div class="s-row"></div>
      <div class="s-row"></div>
      <div class="s-row"></div>
    </div>
  } @else if (hasError()) {
    <div class="inbox-error" role="alert">
      <div class="inbox-error-content">
        <h2 class="inbox-error-title">No pudimos cargar los tickets</h2>
        <p>Revisa tu conexion e intentalo nuevamente.</p>
      </div>
      <button type="button" class="inbox-error-action" (click)="onRetry()">Reintentar</button>
    </div>
  } @else if (!tickets().length) {
    <div class="inbox-empty" role="status">
      <div class="inbox-empty-icon">
        <mat-icon aria-hidden="true">confirmation_number</mat-icon>
      </div>
      <p class="inbox-empty-message">Sin tickets pendientes</p>
      <p class="inbox-empty-hint">Todo esta en orden por ahora.</p>
    </div>
  } @else {
    <div class="inbox-list" role="list">
      @for (ticket of visibleTickets(); track ticket.id) {
        <article
          class="inbox-card"
          role="listitem"
          [class.inbox-card--unread]="isUnread(ticket)"
          (click)="onOpen(ticket)"
        >
          <div class="inbox-card-icon" aria-hidden="true">
            <mat-icon>{{ isUnread(ticket) ? 'mark_email_unread' : 'drafts' }}</mat-icon>
          </div>

          <div class="inbox-card-content">
            <div class="inbox-card-header">
              <div class="inbox-card-pills">
                <span class="inbox-card-code">{{ ticket.code }}</span>
                <span
                  class="inbox-card-status"
                  [class.inbox-card-status--open]="statusKey(ticket) === 'open'"
                  [class.inbox-card-status--in-progress]="statusKey(ticket) === 'in_progress'"
                  [class.inbox-card-status--on-hold]="statusKey(ticket) === 'on_hold'"
                  [class.inbox-card-status--resolved]="statusKey(ticket) === 'resolved'"
                  [class.inbox-card-status--closed]="statusKey(ticket) === 'closed'"
                  [class.inbox-card-status--cancelled]="statusKey(ticket) === 'cancelled'"
                >
                  {{ statusLabel(ticket) }}
                </span>
              </div>
              <h2 class="inbox-card-title">{{ titleLabel(ticket) }}</h2>
            </div>
            <p class="inbox-card-from">Solicitante Â· {{ requesterLabel(ticket) }}</p>
          </div>

          <time class="inbox-card-time">{{ updatedAgo(ticket) }}</time>
        </article>
      }
    </div>
    <mat-paginator
      class="inbox-paginator"
      [length]="tickets().length"
      [pageIndex]="pageIndex()"
      [pageSize]="pageSize()"
      [pageSizeOptions]="pageSizeOptions"
      (page)="onPageChange($event)"
      showFirstLastButtons
      aria-label="Paginacion de tickets"
    ></mat-paginator>
  }
</section>
